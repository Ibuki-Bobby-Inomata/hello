<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>加速度の値を得る</title>
</head>

<body>
    <div id="txt">ここにデータを表示</div> <!-- データを表示するdiv要素 -->

    <script>
        // var acc_x = 0, acc_y = 0, acc_z = 0;                     // 加速度の値を入れる変数を3個用意
        // var do_alpha = 0, do_beta = 0, do_gamma = 0;             // ジャイロの値を入れる変数を3個用意
        let sensorData = {
            // データ取得開始時刻を格納
            // date: null,

            // デバイスの向き（角度）
            do_absolute: null,
            do_alpha: null,
            do_beta: null,
            do_gamma: null,

            // 加速度（重力含まず）
            acc_g_x: null,
            acc_g_y: null,
            acc_g_z: null,

            // 加速度（重力含む）
            acc_x: null,
            acc_y: null,
            acc_z: null,

            // 回転速度
            rot_alpha: null,
            rot_beta: null,
            rot_gamma: null
        };

        window.addEventListener('deviceorientation', (event) => {
            event.preventDefault();
            sensorData.do_absolute = (event.absolute !== null) ? event.absolute : false;
            sensorData.do_alpha = event.alpha;
            sensorData.do_beta = event.beta;
            sensorData.do_gamma = event.gamma;
        }, true);

        window.addEventListener('devicemotion', (event) => {
            event.preventDefault();
            sensorData.acc_g_x = event.accelerationIncludingGravity.x;
            sensorData.acc_g_y = event.accelerationIncludingGravity.y;
            sensorData.acc_g_z = event.accelerationIncludingGravity.z;
            sensorData.acc_x = event.acceleration.x;
            sensorData.acc_y = event.acceleration.y;
            sensorData.acc_z = event.acceleration.z;
            sensorData.rot_alpha = event.rotationRate.alpha;
            sensorData.rot_beta = event.rotationRate.beta;
            sensorData.rot_gamma = event.rotationRate.gamma;
        }, true);


        // // 加速度センサの値が変化したら実行される devicemotion イベント
        // window.addEventListener("devicemotion", (dat) => {
        //     acc_x = dat.accelerationIncludingGravity.x;    // x軸の重力加速度（Android と iOSでは正負が逆）
        //     acc_y = dat.accelerationIncludingGravity.y;    // y軸の重力加速度（Android と iOSでは正負が逆）
        //     acc_z = dat.accelerationIncludingGravity.z;    // z軸の重力加速度（Android と iOSでは正負が逆）
        // });


        // // ジャイロセンサの値が変化したら実行される deviceorientation イベント
        // window.addEventListener("deviceorientation", (dat) => {
        //     do_alpha = dat.alpha;  // z軸（表裏）まわりの回転の角度（反時計回りがプラス）
        //     do_beta = dat.beta;   // x軸（左右）まわりの回転の角度（引き起こすとプラス）
        //     do_gamma = dat.gamma;  // y軸（上下）まわりの回転の角度（右に傾けるとプラス）
        // });



        // 指定時間ごとに繰り返し実行される setInterval(実行する内容, 間隔[ms]) タイマーを設定
        var timer = window.setInterval(() => {
            displayData();      // displayData 関数を実行
        }, 1); // 33msごとに（1秒間に約30回）

        // データを表示する displayData 関数
        function displayData() {
            var txt = document.getElementById("txt");   // データを表示するdiv要素の取得
            txt.innerHTML = "acc_x: " + sensorData.acc_x + "<br>"         // x軸の値
                + "acc_y: " + sensorData.acc_y + "<br>"         // y軸の値
                + "acc_z: " + sensorData.acc_z + "<br>"
                + "rot_alpha: " + sensorData.rot_alpha + "<br>"         // x軸の値
                + "rot_beta: " + sensorData.rot_beta + "<br>"         // y軸の値
                + "rot_gamma: " + sensorData.rot_gamma+ "<br>" // x軸の値
                + "do_alpha: " + sensorData.do_alpha + "<br>"         // y軸の値
                + "do_beta: " + sensorData.do_beta + "<br>"
                + "do_gamma: " + sensorData.do_gamma;                 // z軸の値
        }
    </script>

</body>

</html>